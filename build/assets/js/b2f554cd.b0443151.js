"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1477],{10:e=>{e.exports=JSON.parse('{"blogPosts":[{"id":"pwsh-challenge-002","metadata":{"permalink":"/blog/pwsh-challenge-002","source":"@site/blog/2023-08-02-pwsh-challenge002/PWSH-Challenge-002.md","title":"Challenge 2 - Folder Size Report with PowerShell","description":"Create a script that can download any file by the URL given by a user.","date":"2023-08-07T11:00:00.000Z","formattedDate":"August 7, 2023","tags":[{"label":"PowerShell","permalink":"/blog/tags/power-shell"},{"label":"Script","permalink":"/blog/tags/script"},{"label":"Challenge","permalink":"/blog/tags/challenge"}],"readingTime":3.3766666666666665,"hasTruncateMarker":true,"authors":[{"name":"Will","title":"Creator of the IT KB.","url":"https://github.com/BassJamm?tab=repositories"}],"frontMatter":{"draft":false,"title":"Challenge 2 - Folder Size Report with PowerShell","description":"Create a script that can download any file by the URL given by a user.","slug":"pwsh-challenge-002","date":"2023-08-07T11:00","authors":[{"name":"Will","title":"Creator of the IT KB.","url":"https://github.com/BassJamm?tab=repositories"}],"tags":["PowerShell","Script","Challenge"],"image":"https://cdn.hashnode.com/res/hashnode/image/upload/v1690624765820/c7da8f32-0c1e-4ca0-a807-bb4efe449c18.png?w=1600&h=840&fit=crop&crop=entropy&auto=compress,format&format=webp","hide_table_of_contents":false},"nextItem":{"title":"Microsoft Defender for Endpoint Woes","permalink":"/blog/Defender-for-Endpoint-Woes"}},"content":"Create a script that calculates the total size of a given folder and all its subfolders (recursively). The script should display the size in a human-readable format (e.g., KB, MB, GB).\\r\\n\\r\\n\x3c!--truncate--\x3e\\r\\n:::info Quick Social Plug\\r\\n\\r\\nCheck out my other post locations: -\\r\\n\\r\\n- [HashNode Link](https://willh.hashnode.dev/)\\r\\n- [Patreon Link](https://patreon.com/BassJamm?utm_medium=clipboard_copy&utm_source=copyLink&utm_campaign=creatorshare_creator&utm_content=join_link)\\r\\n\\r\\n:::\\r\\n\\r\\n## End Result\\r\\n\\r\\nThought I would put the result first, and save people from scrolling, those who wish to see the process can read the rest of this!\\r\\n\\r\\nI decided not to add any error handling into this, as it\'s quite hard to break this one!\\r\\n\\r\\n:::note\\r\\n\\r\\nSorry for the backticks, it makes it a bit easier to read on the page as it\'s quite slim!\\r\\n\\r\\n:::\\r\\n\\r\\n[Link to script in GitHub!](https://github.com/BassJamm/PowerShellChallenge/blob/51799e1b087f846285f15bff9df9f019caa12fdc/Folder-Report/TOOL-Folder-Report.ps1)\\r\\n\\r\\n```powershell showLineNumbers\\r\\n###### Prompt user for flder input. ######\\r\\n$sourceDirectory = Read-Host -Prompt \\"Please enter the directory you wish to scan\\"\\r\\n\\r\\n###### Get all Directories in that location. ######\\r\\nWrite-Host \\"Collecting the diretory information.\\" -ForegroundColor Yellow\\r\\n$ChildDirectories = (Get-ChildItem $sourceDirectory -Directory).FullName\\r\\nStart-Sleep 1\\r\\nWrite-Host \\"Directories found successfully.\\" -ForegroundColor Green\\r\\n\\r\\n###### Foreach directory get all items recursively. ######\\r\\nWrite-Host \\"Processing items.\\" -ForegroundColor Yellow\\r\\n$childDirectorySizes = foreach ($folder in $ChildDirectories) {\\r\\n    [PSCustomObject]@{\\r\\n        \\"Location\\"  = $folder\\r\\n        \\"FileItems\\" = (Get-ChildItem $folder -Recurse -Force | Where-Object { $_.PSIsContainer -eq $false } | Measure-Object | Select-Object Count).Count\\r\\n        \\"Size(MB)\\"  = [Math]::Round((Get-ChildItem $folder -Recurse -Force | Where-Object { $_.PSIsContainer -eq $false } | Measure-Object -Property Length -Sum | Select-Object Sum).Sum / 1MB, 3)\\r\\n    }\\r\\n\\r\\n}\\r\\nWrite-Host \\"All subdirectories processed successfully.\\" -ForegroundColor Green\\r\\n\\r\\n###### Provide a size report of the directory and child directories. ######\\r\\n$childDirectorySizes | Format-Table * -AutoSize\\r\\n\\r\\n```\\r\\n\\r\\n## Building the script\\r\\n\\r\\nI would like to start by saying I am not an expert at this but, these challenges prompt learning and thus I aim to be better for the next challenge and so on.\\r\\n\\r\\n### Prompting for user input\\r\\n\\r\\nFirstly, we need to get the folder location from the end user. I\'ve done this using the Read-Host command with the `-prompt` parameter. This is a staple command I have found in almost every script requiring user input.\\r\\n\\r\\n```powershell showLineNumbers\\r\\n$sourceDirectory = Read-Host -Prompt \\"Please enter the directory you wish to scan\\"\\r\\n```\\r\\n\\r\\nThe `Read-Host -prompt` input is then stored in the `$sourceDirectory`` variable for later use.\\r\\n\\r\\n### Getting the Folders\\r\\n\\r\\nSecondly, we need to identify the folders that are within the directory the user gave us. We are doing this with the `Get-ChildItem` command, which gets everything in that location, Folders, or Files.\\r\\n\\r\\nI\'m then piping this `|` into a `Where-Object` command which then identifies the Folders or containers.\\r\\n\\r\\n:::info\\r\\nI\'ve added a sort by \\"name\\" at the end, as I want to display the first 10 items in the console, to indicate that the script has found items to the end user. It is completely unnecessary!\\r\\n:::\\r\\n\\r\\n```powershell showlineNumbers\\r\\n###### Prompt user for flder input. ######\\r\\n$sourceDirectory = Read-Host -Prompt \\"Please enter the directory you wish to scan\\"\\r\\n```\\r\\n\\r\\nWe then get all of hte directories in the folder location promtped for using the lin above.\\r\\n\\r\\n```powershell showLineNumbers\\r\\n###### Get all Directories in that location. ######\\r\\n$ChildDirectories = (Get-ChildItem $sourceDirectory -Directory).FullName\\r\\nStart-Sleep 1 # Add this for slightly better pacing when using the script.\\r\\n\\r\\n```\\r\\n\\r\\n### Getting the Folder Sizes\\r\\n\\r\\nThirdly, we need to get the folder sizes and convert them into a nicer format to read, quite a bit to unpack on this one, so please bear with my explanation; you may also want to blow this image up, it\'s a little small, sorry!\\r\\n\\r\\n```powershell showLineNumbers\\r\\n###### Foreach directory get all items recursively. ######\\r\\nWrite-Host \\"Processing items.\\" -ForegroundColor Yellow\\r\\n$childDirectorySizes = foreach ($folder in $ChildDirectories) {\\r\\n    [PSCustomObject]@{\\r\\n        \\"Location\\"  = $folder\\r\\n        \\"FileItems\\" = (Get-ChildItem $folder -Recurse -Force | Where-Object { $_.PSIsContainer -eq $false } | Measure-Object | Select-Object Count).Count\\r\\n        \\"Size(MB)\\"  = [Math]::Round((Get-ChildItem $folder -Recurse -Force | Where-Object { $_.PSIsContainer -eq $false } | Measure-Object -Property Length -Sum | Select-Object Sum).Sum / 1MB, 3)\\r\\n    }\\r\\n}\\r\\n```\\r\\n\\r\\nI\'ve created a new variable called, `$childDirectorySizes` in this variable, we are going to store the output of the foreach loop.\\r\\n\\r\\nThe foreach the argument takes each folder entry found within the `$ChildDirectories` & then loops through the script inside the squiggly brackets.\\r\\n\\r\\n```powershell showLineNumbers\\r\\nforeach ($folder in $ChildDirectories)\\r\\n```\\r\\n\\r\\nThe foreach loop does the following: -\\r\\n\\r\\n1. Grabs the full file paths for each file recursively using `Get-ChildItem $folder.FullName -recurse -force`.\\r\\n2. Then it searches for any objects that are not a Folder using `Where-Object {$_.PSIsContainer -eq $false}`.\\r\\n3. It then measures the object using `Measure-Object -property Length -sum`.\\r\\n4. We then select only the one property that we want, `Select-Object Sum`.\\r\\n5. It then stores results inside the variable `$subFolderItems`.\\r\\n6. We then create a new PowerShell object using the command, `[PSCustomObject]`, as this is going to be a new Hash table, we add the `@{}` after it, all properties go inside the squiggly brackets.\\r\\n7. We then create 2 new properties, `Location` and `Size(MB)`. For each of these properties, we need to tell it where the information comes from and how to format it.\\r\\n\\r\\nFor `Location`, we are going to use the Items Full name, which is equal to its full UNC path. `$folder.FullName`.\\r\\n\\r\\nFor `Size(MB)`, we are going to use the Output of steps 1 to 5. The output from this should be the SUM of all the files under the folder item that\'s stored in the variable `$folder` which is in the foreach loop argument.\\r\\n\\r\\nWe also want to round this to MBs with 2 Decimal places; we can do this with the command, `[Math]::Round($subFolderItems.sum /1MB, 2)`.\\r\\n\\r\\n### Creating a console Ouput\\r\\n\\r\\nFor this point, I have taken the variable that is holding the output from the Foreach loop noted above and piped this into a Format-Table command with the order of the properties to show.\\r\\n\\r\\n```powershell showLineNumbers\\r\\n###### Provide a size report of the directory and child directories. ######\\r\\n$childDirectorySizes | Format-Table * -AutoSize\\r\\n```\\r\\n\\r\\nWhich gives you this.\\r\\n\\r\\n```powershell showLineNumbers\\r\\nLocation                           FileItems Size(MB)\\r\\n--------                           --------- --------\\r\\nC:\\\\GitRepos\\\\100-days-of-javascript       287   59.772\\r\\nC:\\\\GitRepos\\\\PowerShellChallenge          106    0.072\\r\\nC:\\\\GitRepos\\\\Private-Code-Dump            253   14.089\\r\\nC:\\\\GitRepos\\\\python-app                    97    0.067\\r\\nC:\\\\GitRepos\\\\The-IT-Knowledge-base      36396  414.871\\r\\n```"},{"id":"Defender-for-Endpoint-Woes","metadata":{"permalink":"/blog/Defender-for-Endpoint-Woes","source":"@site/blog/2023-09-12-Defender-Woes/Microsoft-Defender-for-Endpoint-Woes.md","title":"Microsoft Defender for Endpoint Woes","description":"Windows services hating each other on Server 2012 R2.","date":"2023-08-05T11:00:00.000Z","formattedDate":"August 5, 2023","tags":[{"label":"Defender","permalink":"/blog/tags/defender"},{"label":"Azure","permalink":"/blog/tags/azure"}],"readingTime":1.3333333333333333,"hasTruncateMarker":true,"authors":[{"name":"Will","title":"Creator of the IT KB.","url":"https://github.com/BassJamm?tab=repositories"}],"frontMatter":{"title":"Microsoft Defender for Endpoint Woes","description":"Windows services hating each other on Server 2012 R2.","slug":"Defender-for-Endpoint-Woes","date":"2023-08-05T11:00","authors":[{"name":"Will","title":"Creator of the IT KB.","url":"https://github.com/BassJamm?tab=repositories"}],"tags":["Defender","Azure"],"image":"https://i.imgur.com/mErPwqL.png","hide_table_of_contents":false},"prevItem":{"title":"Challenge 2 - Folder Size Report with PowerShell","permalink":"/blog/pwsh-challenge-002"},"nextItem":{"title":"Challenge 1 - File Download Script with PowerShell","permalink":"/blog/pwsh-challenge-001"}},"content":"For the last 3 months our monitoring team at my workplace has been spammed with alerts about the Windows Defender Advanced Threat Protection Service has entered the \\"stopped\\" state for one 2012 R2 server.\\r\\n\\r\\nQuickly followed about 6 minutes later with another alert saying, the service is okay.\\r\\n\x3c!--truncate--\x3e\\r\\n:::info Quick Social Plug\\r\\n\\r\\nCheck out my other post locations: -\\r\\n\\r\\n- [HashNode Link](https://willh.hashnode.dev/)\\r\\n\\r\\n:::\\r\\n\\r\\n## The Investigation\\r\\n\\r\\nFrom checking the alert, I could see the service was stopping and starting but, no real reason as to why it was doing this. This is when I turned to PowerShell (*still unsure of why I did this over trusty Event Viewer, just seems to be my default now*).\\r\\n\\r\\nQuickly smashed out the below command to see what I could find.\\r\\n\\r\\nThis promptly spat out these errors.\\r\\n\\r\\nAfter googling this (as any techy would), there are a lot of mentions of this error message all over the place with suggestions to do the following:-\\r\\n\\r\\n1. Disable or uninstall any other AV products on the device.\\r\\n\\r\\n2. Run a Full system scan for viruses.\\r\\n\\r\\n3. Run a System File Checker scan from the command line, `sfc /scannow`.\\r\\n\\r\\n4. Re-install the Defender for Endpoint on that device.\\r\\n\\r\\n5. Update the OS to a new version (*A bit extreme mind you however, new OS versions have much better support for Defender, you don\'t need this service on Server 2016 and above, so it\'s still valid!*)\\r\\n\\r\\n## What Solved It\\r\\n\\r\\nThe short answer is, I\'m not 100% certain.\\r\\n\\r\\nOur first port of call was to remove the *System Center Endpoint Protection* application, which we probably should have done before installing the *Defender for Endpoint* application to be honest.\\r\\n\\r\\nSecondly, we off-boarded the appliance from Defedner and then on-boarded it again by doing the following: -\\r\\n\\r\\n- Download the off-boarding script from your Defender portal.\\r\\n\\r\\n  - In the navigation pane, select Settings &gt; Endpoints &gt; Device management &gt; Offboarding.\\r\\n\\r\\n- Off-Board the Server using the script provided by Microsoft below.\\r\\n\\r\\n  - `C:\\\\Packages\\\\Plugins\\\\Microsoft.Azure.AzureDefenderForServers.MDE.Windows\\\\versionNo\\\\Install.ps1.`\\r\\n\\r\\n  - The command is, `Install.ps1 -OffboardingScript .\\\\WindowsDefenderATPOffboardingScript_valid_until_*.cmd`\\r\\n\\r\\n- Reboot the server.\\r\\n\\r\\n- Check the Defender application is gone from Programs and Features and that the Services are gone. If not, manually uninstall using Programs and Features.\\r\\n\\r\\n- On-Board the server again using the script provided by Microsoft. Command below.\\r\\n\\r\\n  - `C:\\\\Packages\\\\Plugins\\\\Microsoft.Azure.AzureDefenderForServers.MDE.Windows\\\\versionNo\\\\Install.ps1.`\\r\\n\\r\\n  - The command is, `.\\\\Install.ps1 -OnboardingScript .\\\\WindowsDefenderATPOnboardingScript_valid_until_*.cmd`\\r\\n\\r\\n- Reboot the server.\\r\\n\\r\\nHopefully this helps somone!"},{"id":"pwsh-challenge-001","metadata":{"permalink":"/blog/pwsh-challenge-001","source":"@site/blog/2023-08-05-pwsh-challenge001/PWSH-challenge-001.md","title":"Challenge 1 - File Download Script with PowerShell","description":"Create a script that can download any file by the URL given by a user.","date":"2023-08-05T11:00:00.000Z","formattedDate":"August 5, 2023","tags":[{"label":"PowerShell","permalink":"/blog/tags/power-shell"},{"label":"Script","permalink":"/blog/tags/script"},{"label":"Challenge","permalink":"/blog/tags/challenge"}],"readingTime":3.4366666666666665,"hasTruncateMarker":true,"authors":[{"name":"Will","title":"Creator of the IT KB.","url":"https://github.com/BassJamm?tab=repositories"}],"frontMatter":{"title":"Challenge 1 - File Download Script with PowerShell","description":"Create a script that can download any file by the URL given by a user.","slug":"pwsh-challenge-001","date":"2023-08-05T11:00","authors":[{"name":"Will","title":"Creator of the IT KB.","url":"https://github.com/BassJamm?tab=repositories"}],"tags":["PowerShell","Script","Challenge"],"image":"https://i.imgur.com/mErPwqL.png","hide_table_of_contents":false},"prevItem":{"title":"Microsoft Defender for Endpoint Woes","permalink":"/blog/Defender-for-Endpoint-Woes"},"nextItem":{"title":"Welcome!","permalink":"/blog/welcome"}},"content":"Create a script that can download any file by the URL given by a user. Add in the ability to download multiple items at once.\\r\\n\\r\\n\x3c!--truncate--\x3e\\r\\n:::info Quick Social Plug\\r\\n\\r\\nCheck out my other post locations: -\\r\\n\\r\\n- [HashNode Link](https://willh.hashnode.dev/)\\r\\n- [Patreon Link](https://patreon.com/BassJamm?utm_medium=clipboard_copy&utm_source=copyLink&utm_campaign=creatorshare_creator&utm_content=join_link)\\r\\n\\r\\n:::\\r\\n\\r\\n## Creating the script\\r\\n\\r\\n### Basic functionality\\r\\n\\r\\nFirstly, we\'ll create the logic outline, by that I mean, create the bare bones of the script without any error handling or console output.\\r\\n\\r\\n:::note\\r\\n\\r\\nI\'ve seen parameter blocks written in multiple ways, I write them this way as I think they\'re more easily understood by those who are not familiar with them.\\r\\n\\r\\n:::\\r\\n\\r\\n```powershell showLineNumbers\\r\\n<# Parameter List #>\\r\\n[CmdletBinding()]\\r\\nparam (\\r\\n    [Parameter(Mandatory=$true)]\\r\\n    [string] $Source,\\r\\n    [Parameter(Mandatory=$true)]\\r\\n    [string] $Destination\\r\\n)\\r\\n<# Bare bones of the command to download an item. #>\\r\\nStart-BitsTransfer -Source $Source -Destination $Destination -TransferType Download\\r\\n```\\r\\n\\r\\nRunning the above script file by type `.\\\\TOOL-File-download.ps1 -Source \\"`[`https://go.microsoft.com/fwlink/p/?LinkID=2195167&clcid=0x409&culture=en-us&country=US`](https://go.microsoft.com/fwlink/p/?LinkID=2195167&clcid=0x409&culture=en-us&country=US)`\\" -Destination C:\\\\Temp\\\\Server2019.iso` does the job; the output is below.\\r\\n\\r\\nNow to add the ability to see running jobs and historic jobs.\\r\\n\\r\\n## Adding running and historic job reports\\r\\n\\r\\nAs you can see below, this is becoming a bit longer but, I would not say it is getting any more complex.\\r\\n\\r\\n```powershell showLineNumbers\\r\\n\\r\\n<# Parameter List #>\\r\\n[CmdletBinding()]\\r\\nparam (\\r\\n    [Parameter()]\\r\\n    [switch] $JobReport,\\r\\n    [Parameter()]\\r\\n    [switch] $JobHistory\\r\\n)\\r\\n###### Add the ability to review in-progress download job(s). ######\\r\\nif ($JobReport) {\\r\\n    <# Action to perform if the condition is true #>\\r\\n    Write-Host \\"Getting running downloads.\\"\\r\\n    Get-BitsTransfer | Where-Object JobState -EQ \'transferring\' | Format-Table JobId, CreationTime,DisplayName,TransferType,JobState,BytesTransferred,BytesTotal -AutoSize\\r\\n}\\r\\n###### Add the ability to review historic job(s). ######\\r\\nif ($JobHistory) {\\r\\n    <# Action to perform if the condition is true #>\\r\\n    Write-Host \\"Getting historic downloads.\\"\\r\\n    Get-BitsTransfer | Sort-Object CreationTime -Descending | Format-Table JobId, CreationTime,DisplayName,TransferType,JobState,BytesTransferred,BytesTotal -AutoSize\\r\\n}\\r\\n```\\r\\n\\r\\nNow to add a way to cancel running jobs.\\r\\n\\r\\n## Canceling jobs\\r\\n\\r\\nBelow I have added the code to cancel a running job, although a bit basic and rough it does work.\\r\\n\\r\\n```powershell showLineNumbers\\r\\n\\r\\n<# Parameter List #>\\r\\n[CmdletBinding()]\\r\\nparam (\\r\\n    [Parameter()]\\r\\n    [String] $CancelJob\\r\\n)\\r\\n\\r\\n###### Add the ability to cancel job(s). ######\\r\\nif ($CancelJob) {\\r\\n    <# Action to perform if the condition is true #>\\r\\n    Get-BitsTransfer -Name $CancelJob | Remove-BitsTransfer\\r\\n    Get-BitsTransfer | Where-Object JobState -EQ \'transferring\' | Format-Table JobId, CreationTime,DisplayName,TransferType,JobState,BytesTransferred,BytesTotal -AutoSize\\r\\n    \\r\\n}\\r\\n```\\r\\n\\r\\n## Adding in some error handling and console output\\r\\n\\r\\nBelow I have added in some \'fluff\', some try\\\\\\\\catch blocks and some write-host functionality to make using this a bit easier.\\r\\n\\r\\nTry\\\\\\\\Catch blocks are a godsend when it comes to error handling, essentially it means try what is in the try area and catch anything that comes out of it.\\r\\n\\r\\n### Downloading the file section\\r\\n\\r\\n```powershell showLineNumbers\\r\\n###### Download a file. ######\\r\\nif ($Source) {\\r\\n    <# Action to perform if the condition is true #>\\r\\n    try {\\r\\n        Start-BitsTransfer -Source $Source -Destination $Destination -TransferType Download -Asynchronous -DisplayName $JobName\\r\\n        Write-Host \\"Beginning download from $($Source).\\"\\r\\n        Write-Host \\"\\" # This just adds some more space in the console.\\r\\n        \\r\\n    }\\r\\n    catch {\\r\\n        <#Do this if a terminating exception happens#>\\r\\n        Write-Host \\"Error when starting the job.\\"\\r\\n        $_\\r\\n    }\\r\\n}\\r\\n```\\r\\n\\r\\n### Canceling the download section\\r\\n\\r\\n```powershell showLineNumbers\\r\\n\\r\\n###### Add the ability to cancel job(s). ######\\r\\nif ($CancelJob) {\\r\\n    <# Action to perform if the condition is true #>\\r\\n    try {\\r\\n        Get-BitsTransfer -Name $CancelJob | Remove-BitsTransfer\\r\\n        Write-Host \\"Job cancelled successfully.\\" -ForegroundColor Green\\r\\n        Write-Host \\"\\" # This just adds some more space in the console.\\r\\n        Start-sleep 2\\r\\n        Write-Host \\"Remaining jobs listed below.\\" -ForegroundColor Yellow\\r\\n        Write-Host \\"\\" # This just adds some more space in the console.\\r\\n        Start-sleep 1\\r\\n        Get-BitsTransfer | Where-Object JobState -EQ \'transferring\' | Format-Table JobId, CreationTime,DisplayName,TransferType,JobState,BytesTransferred,BytesTotal -AutoSize    \\r\\n    }\\r\\n    catch {\\r\\n        <#Do this if a terminating exception happens#>\\r\\n        Write-Host \\"Error when cancelling job.\\"\\r\\n        $_\\r\\n    }\\r\\n}\\r\\n```\\r\\n\\r\\n## Full Script\\r\\n\\r\\n```powershell\\r\\n\\r\\n<# Parameter List #>\\r\\n[CmdletBinding()]\\r\\nparam (\\r\\n    [Parameter()]\\r\\n    [string] $Source,\\r\\n    [Parameter()]\\r\\n    [string] $Destination,\\r\\n    [Parameter()]\\r\\n    [string] $JobName,\\r\\n    [Parameter()]\\r\\n    [switch] $RunningJobs,\\r\\n    [Parameter()]\\r\\n    [switch] $JobHistory,\\r\\n    [Parameter()]\\r\\n    [String] $CancelJob\\r\\n)\\r\\n###### Download a file. ######\\r\\nif ($Source) {\\r\\n    <# Action to perform if the condition is true #>\\r\\n    try {\\r\\n        Start-BitsTransfer -Source $Source -Destination $Destination -TransferType Download -Asynchronous -DisplayName $JobName\\r\\n        Write-Host \\"Beginning download from $($Source).\\"\\r\\n        Write-Host \\"\\" # This just adds some more space in the console.\\r\\n        \\r\\n    }\\r\\n    catch {\\r\\n        <#Do this if a terminating exception happens#>\\r\\n        Write-Host \\"Error when starting the job.\\"\\r\\n        $_\\r\\n    }\\r\\n}\\r\\n\\r\\n###### Add the ability to review in-progress download job(s). ######\\r\\nif ($RunningJobs) {\\r\\n    <# Action to perform if the condition is true #>\\r\\n    Write-Host \\"Getting running downloads.\\"\\r\\n    Write-Host \\"\\" # This just adds some more space in the console.\\r\\n    Get-BitsTransfer | Where-Object JobState -EQ \'transferring\' | Format-Table JobId, CreationTime,DisplayName,TransferType,JobState,BytesTransferred,BytesTotal -AutoSize\\r\\n}\\r\\n\\r\\n###### Add the ability to review historic job(s). ######\\r\\nif ($JobHistory) {\\r\\n    <# Action to perform if the condition is true #>\\r\\n    Write-Host \\"Getting historic downloads.\\"\\r\\n    Get-BitsTransfer | Sort-Object CreationTime -Descending | Format-Table JobId, CreationTime,DisplayName,TransferType,JobState,BytesTransferred,BytesTotal -AutoSize\\r\\n}\\r\\n\\r\\n###### Add the ability to cancel job(s). ######\\r\\nif ($CancelJob) {\\r\\n    <# Action to perform if the condition is true #>\\r\\n\\r\\n    try {\\r\\n        Get-BitsTransfer -Name $CancelJob | Remove-BitsTransfer\\r\\n        Write-Host \\"Job cancelled successfully.\\" -ForegroundColor Green\\r\\n        Write-Host \\"\\" # This just adds some more space in the console.\\r\\n        Start-sleep 2\\r\\n        Write-Host \\"Remaining jobs listed below.\\" -ForegroundColor Yellow\\r\\n        Write-Host \\"\\" # This just adds some more space in the console.\\r\\n        Start-sleep 1\\r\\n        Get-BitsTransfer | Where-Object JobState -EQ \'transferring\' | Format-Table JobId, CreationTime,DisplayName,TransferType,JobState,BytesTransferred,BytesTotal -AutoSize\\r\\n        \\r\\n    }\\r\\n    catch {\\r\\n        <#Do this if a terminating exception happens#>\\r\\n        Write-Host \\"Error when cancelling job.\\"\\r\\n        $_\\r\\n    }\\r\\n\\r\\n}\\r\\n```\\r\\n\\r\\n## Bonus: Multiple downloads\\r\\n\\r\\nThe `Start-BitsTransfer` command supports pipeline input, so you can add multiple download links using a text file.\\r\\n\\r\\nCreate a text file in the format below, this is a typical csv format.\\r\\n\\r\\n![](<https://cdn.hashnode.com/res/hashnode/image/upload/v1690560380176/0d5d0ab7-5b77-4010-9ed7-e30d780a510a.png> align=\\"center\\")\\r\\n\\r\\nAdditional Code was added to the script.\\r\\n\\r\\n```powershell\\r\\n\\r\\n<# Parameter List #>\\r\\n[CmdletBinding()]\\r\\nparam (\\r\\n    [Parameter()]\\r\\n    [string] $MultiJobDownload\\r\\n)\\r\\n###### Download multiple files. ######\\r\\nif ($MultiJobDownload) {\\r\\n    <# Action to perform if the condition is true #>\\r\\n    try {\\r\\n        Import-csv -Path $MultiJobDownload | Start-BitsTransfer -Asynchronous\\r\\n        Write-Host \\"Beginning download from listed sources.\\"\\r\\n        Write-Host \\"\\" # This just adds some more space in the console.\\r\\n        Start-Sleep 1\\r\\n        Write-Host \\" Sources and destinations below: -\\"\\r\\n        Get-Content -Path $MultiJobDownload\\r\\n        \\r\\n    }\\r\\n    catch {\\r\\n        <#Do this if a terminating exception happens#>\\r\\n        Write-Host \\"Error when starting the job.\\"\\r\\n        $_\\r\\n    }\\r\\n}\\r\\n```"},{"id":"welcome","metadata":{"permalink":"/blog/welcome","source":"@site/blog/2023-05-20-welcome/index.md","title":"Welcome!","description":"First blog post.","date":"2023-05-20T10:00:00.000Z","formattedDate":"May 20, 2023","tags":[{"label":"hello","permalink":"/blog/tags/hello"},{"label":"docusaurus-v2","permalink":"/blog/tags/docusaurus-v-2"}],"readingTime":0.09,"hasTruncateMarker":true,"authors":[{"name":"Will","title":"Creator of the IT KB.","url":"https://github.com/BassJamm?tab=repositories"}],"frontMatter":{"title":"Welcome!","description":"First blog post.","slug":"welcome","date":"2023-05-20T10:00","authors":[{"name":"Will","title":"Creator of the IT KB.","url":"https://github.com/BassJamm?tab=repositories"}],"tags":["hello","docusaurus-v2"],"image":"https://i.imgur.com/mErPwqL.png","hide_table_of_contents":false},"prevItem":{"title":"Challenge 1 - File Download Script with PowerShell","permalink":"/blog/pwsh-challenge-001"}},"content":"Welcome to the blog.\\n\\nThis blog is created with [**Docusaurus 2**](https://docusaurus.io/).\\n\\n\x3c!--truncate--\x3e\\n:::info Quick Social Plug\\n\\nCheck out my other post locations: -\\n\\n- [HashNode Link](https://willh.hashnode.dev/)\\n\\n:::"}]}')}}]);