"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5226],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=i.createContext({}),c=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=c(e.components);return i.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},h=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(n),h=a,m=u["".concat(s,".").concat(h)]||u[h]||d[h]||o;return n?i.createElement(m,r(r({ref:t},p),{},{components:n})):i.createElement(m,r({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:a,r[1]=l;for(var c=2;c<o;c++)r[c]=n[c];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}h.displayName="MDXCreateElement"},5643:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var i=n(7462),a=(n(7294),n(3905));const o={sidebar_position:1,id:"Troubleshooting a connectivity issue",title:"Troubleshooting a connectivity issue",tags:["Tutorial","Networking","Issue"]},r=void 0,l={unversionedId:"Scenario based Guidance/Troubleshooting a connectivity issue",id:"Scenario based Guidance/Troubleshooting a connectivity issue",title:"Troubleshooting a connectivity issue",description:"Case study to aid in troubleshooting a networking issue scenario (from a infrastructure perspective) that has happened recently.",source:"@site/docs/Scenario based Guidance/Troubleshooting a connectivity issue.md",sourceDirName:"Scenario based Guidance",slug:"/Scenario based Guidance/Troubleshooting a connectivity issue",permalink:"/Scenario based Guidance/Troubleshooting a connectivity issue",draft:!1,tags:[{label:"Tutorial",permalink:"/tags/tutorial"},{label:"Networking",permalink:"/tags/networking"},{label:"Issue",permalink:"/tags/issue"}],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,id:"Troubleshooting a connectivity issue",title:"Troubleshooting a connectivity issue",tags:["Tutorial","Networking","Issue"]},sidebar:"tutorialSidebar",previous:{title:"Scenario based Guidance",permalink:"/category/scenario-based-guidance"}},s={},c=[{value:"Scenario for example",id:"scenario-for-example",level:2},{value:"What needs to be confirmed",id:"what-needs-to-be-confirmed",level:2},{value:"Can the client device reach the server at all?",id:"can-the-client-device-reach-the-server-at-all",level:2},{value:"Next step",id:"next-step",level:3},{value:"Check what is blocking the TCP connection",id:"check-what-is-blocking-the-tcp-connection",level:2},{value:"Check if the port is listening",id:"check-if-the-port-is-listening",level:3},{value:"Check Windows Firewall",id:"check-windows-firewall",level:3},{value:"Adding a Windows Firewall rule",id:"adding-a-windows-firewall-rule",level:3},{value:"Testing the connection again",id:"testing-the-connection-again",level:2}],p={toc:c};function u(e){let{components:t,...o}=e;return(0,a.kt)("wrapper",(0,i.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Case study to aid in troubleshooting a networking issue scenario (from a infrastructure perspective) that has happened recently."),(0,a.kt)("h2",{id:"scenario-for-example"},"Scenario for example"),(0,a.kt)("p",null,"We've got a server hosting an application that is managing license assignment to a client installed application."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Server name"),": lichost01.fakedomain.local"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Server IP"),": 192.168.1.15"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Client device name"),": clientdev01"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Client device IP"),": 192.168.1.35"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Application name"),": AmazingLicenseApplication")),(0,a.kt)("p",null,"Server Ports:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Discovery port"),": 6015"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Licese retreival port"),": 5985")),(0,a.kt)("p",null,"Client Ports:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"None specified"))),(0,a.kt)("p",null,"We've got the application installed on the client machine and the license management application installed on the server however, the client application is unable to retreive licesnse from the server hosted application."),(0,a.kt)("p",null,"The Vendor has said that the application configuration looks correct and asked for the network connection between the two devices to be tested."),(0,a.kt)("h2",{id:"what-needs-to-be-confirmed"},"What needs to be confirmed"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Can the client device reach the server at all?"),(0,a.kt)("li",{parentName:"ol"},"Can the client device initiate a connection to the ports required?")),(0,a.kt)("h2",{id:"can-the-client-device-reach-the-server-at-all"},"Can the client device reach the server at all?"),(0,a.kt)("p",null,"Good command to use is ",(0,a.kt)("inlineCode",{parentName:"p"},"test-netconnection"),", it can be abbreviated to ",(0,a.kt)("inlineCode",{parentName:"p"},"tnc"),". This is the PowerShell equivalent (or close to) of ",(0,a.kt)("inlineCode",{parentName:"p"},"telnet")," in CMD ."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Open ",(0,a.kt)("strong",{parentName:"li"},"PowerShell")," on the client device."),(0,a.kt)("li",{parentName:"ol"},"Enter the command ",(0,a.kt)("inlineCode",{parentName:"li"},"tnc -ComputerName lichost01 -Port 6015"),".")),(0,a.kt)("p",null,"We are getting a failure, both for the TCP connection and the Ping; both of these failures would suggest the machine is not reachable from the client device."),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"Worth noting that ICMP or Ping is often blocked on networks, this is a wide spread practice, so do not rely on it.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-powershell"},"WARNING: PING\\ICMP connect to (lichost01) failed\nWARNING: TCP connect to (lichost01 : 6015) failed\n\nComputerName           : lichost01.fakedomain.local\nRemoteAddress          : 192.168.1.15\nRemotePort             : 6015\nInterfaceAlias         : Wi-Fi\nSourceAddress          : 192.168.1.35\nPingSucceeded          : False\nPingReplyDetails (RTT) : 11 ms\nTcpTestSucceeded       : False\n")),(0,a.kt)("h3",{id:"next-step"},"Next step"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Consult a network diagram of the infrastructure, ",(0,a.kt)("strong",{parentName:"li"},"note any devices or hops")," that are between the client device and the server."),(0,a.kt)("li",{parentName:"ol"},"Check with a ",(0,a.kt)("strong",{parentName:"li"},"network engineer")," as to what is between the client device and the server.")),(0,a.kt)("p",null,"In this case, there's a VPN between the client device and the license application host server."),(0,a.kt)("p",null,"After chatting with the network engineer, we've confirmed that  both ports (6015 and 5985) were blocked by the VPN gateway device, being non-standard ports, that is always a possible issue."),(0,a.kt)("p",null,"Now we want to re-run the network test."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Open ",(0,a.kt)("strong",{parentName:"li"},"PowerShell")," on the client device."),(0,a.kt)("li",{parentName:"ol"},"Enter the command ",(0,a.kt)("inlineCode",{parentName:"li"},"tnc -ComputerName lichost01 -Port 6015"),".")),(0,a.kt)("p",null,"This time we see a successful ping communication to the server but, TCP is still failing."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-powershell"},"WARNING: TCP connect to (lichost01 : 6015) failed\n\nComputerName           : lichost01.fakedomain.local\nRemoteAddress          : 192.168.1.15\nRemotePort             : 6015\nInterfaceAlias         : Wi-Fi\nSourceAddress          : 192.168.1.35\nPingSucceeded          : True\nPingReplyDetails (RTT) : 11 ms\nTcpTestSucceeded       : False\n")),(0,a.kt)("h2",{id:"check-what-is-blocking-the-tcp-connection"},"Check what is blocking the TCP connection"),(0,a.kt)("p",null,"Now we've ruled out the VPN being the issue and the ping test is successful, we know the client device can reach the server but, now the client hosted application is unable to connect to port ",(0,a.kt)("inlineCode",{parentName:"p"},"5985")," to retreive a license."),(0,a.kt)("h3",{id:"check-if-the-port-is-listening"},"Check if the port is listening"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Connect to the server application."),(0,a.kt)("li",{parentName:"ol"},"Open ",(0,a.kt)("strong",{parentName:"li"},"PowerShell"),"."),(0,a.kt)("li",{parentName:"ol"},"Type the command ",(0,a.kt)("inlineCode",{parentName:"li"},"Get-NetTCPConnection -LocalPort 5985"),".")),(0,a.kt)("p",null,"You should get something like the below, if not then the port's not active at all."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-powershell"},"PS C:\\Users\\username> Get-NetTCPConnection -LocalPort 5985\n\nLocalAddress                        LocalPort RemoteAddress                       RemotePort State       AppliedSetting\n------------                        --------- -------------                       ---------- -----       --------------\n::                                  5985      ::                                  0          Listen\n\n")),(0,a.kt)("p",null,"So from the above we can see the port is listening and waiting on connections but, the client app is still not able to retrieve a license."),(0,a.kt)("h3",{id:"check-windows-firewall"},"Check Windows Firewall"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Open ",(0,a.kt)("strong",{parentName:"li"},"Resource Monitor")," from the start menu."),(0,a.kt)("li",{parentName:"ol"},"Select the ",(0,a.kt)("strong",{parentName:"li"},"Network tab"),"."),(0,a.kt)("li",{parentName:"ol"},"Expand the ",(0,a.kt)("strong",{parentName:"li"},"Listening Ports")," section via the down arrow on the right.")),(0,a.kt)("p",null,"It should look something like this."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Resource Monitor - Listening ports.jpg",src:n(4126).Z,width:"1091",height:"566"})),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},"Scroll through the ports until you find the relevant port and confirm the Firewall Status.")),(0,a.kt)("p",null,"In our case, it's displaying the Firewall status as ",(0,a.kt)("inlineCode",{parentName:"p"},"Not allowed, not restricted"),", which isn't that helpful but, does give us a hint that the Windows Firewall on the server maybe blocking the connection. "),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"Something to note, Windows firewall is filtering on the way in but, unless specified, outbound will match the rules that are inbound. So if something comes in on such and such a port, the firewall will presume it's allowed outbound (not necessarily on the same port though).")),(0,a.kt)("h3",{id:"adding-a-windows-firewall-rule"},"Adding a Windows Firewall rule"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Search in start for ",(0,a.kt)("inlineCode",{parentName:"li"},"Windows Firewall with Advanced Security"),"."),(0,a.kt)("li",{parentName:"ol"},"Click ",(0,a.kt)("strong",{parentName:"li"},"Inbound Rules")," to load and view the other rules."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Right-Click")," on Inbound Rules, click ",(0,a.kt)("strong",{parentName:"li"},"New Rule"),"..."),(0,a.kt)("li",{parentName:"ol"},"Select ",(0,a.kt)("strong",{parentName:"li"},"Port"),"."),(0,a.kt)("li",{parentName:"ol"},"Select ",(0,a.kt)("strong",{parentName:"li"},"TCP")," & ",(0,a.kt)("strong",{parentName:"li"},"add the port")," number (in this case 5985)."),(0,a.kt)("li",{parentName:"ol"},"Select ",(0,a.kt)("strong",{parentName:"li"},"Allow the connection")," and press next."),(0,a.kt)("li",{parentName:"ol"},"Leave it as ",(0,a.kt)("strong",{parentName:"li"},"all 3 profiles")," selected."),(0,a.kt)("li",{parentName:"ol"},"Enter a ",(0,a.kt)("strong",{parentName:"li"},"description name")," and ",(0,a.kt)("strong",{parentName:"li"},"description")," (more for the next person coming along than anything else)."),(0,a.kt)("li",{parentName:"ol"},"Press ",(0,a.kt)("strong",{parentName:"li"},"Finish"),".")),(0,a.kt)("h2",{id:"testing-the-connection-again"},"Testing the connection again"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Open ",(0,a.kt)("strong",{parentName:"li"},"PowerShell")," on the client device."),(0,a.kt)("li",{parentName:"ol"},"Type the command ",(0,a.kt)("inlineCode",{parentName:"li"},"tnc -ComputerName lichost01 -Port 5985"),".")),(0,a.kt)("p",null,"This time we see a successful TCP connection."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Notice the information for the ping\\icmp test is ignored in a successful connection attempt.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-powershell"},"ComputerName           : lichost01.fakedomain.local\nRemoteAddress          : 192.168.1.15\nRemotePort             : 5985\nInterfaceAlias         : Wi-Fi\nSourceAddress          : 192.168.1.35\nTcpTestSucceeded       : True\n")))}u.isMDXComponent=!0},4126:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/Resource-monitor-001-bc37fb41250fdca87b2fd848d328c5e0.jpeg"}}]);