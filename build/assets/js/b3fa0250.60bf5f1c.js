"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4316],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>k});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},l=Object.keys(e);for(i=0;i<l.length;i++)n=l[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)n=l[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=i.createContext({}),p=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=p(e.components);return i.createElement(s.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},c=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,s=e.parentName,u=r(e,["components","mdxType","originalType","parentName"]),d=p(n),c=a,k=d["".concat(s,".").concat(c)]||d[c]||m[c]||l;return n?i.createElement(k,o(o({ref:t},u),{},{components:n})):i.createElement(k,o({ref:t},u))}));function k(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,o=new Array(l);o[0]=c;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r[d]="string"==typeof e?e:a,o[1]=r;for(var p=2;p<l;p++)o[p]=n[p];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}c.displayName="MDXCreateElement"},5622:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>m,frontMatter:()=>l,metadata:()=>r,toc:()=>p});var i=n(7462),a=(n(7294),n(3905));const l={draft:!1,id:"Windows Device Config",title:"Useful Windows Device Configuration",hide_title:!1,hide_table_of_contents:!1,sidebar_label:"Windows Device Config",sidebar_position:1,toc_max_heading_level:4,pagination_label:"Windows Device Config",tags:[],custom_edit_url:"https://github.com/facebook/docusaurus/edit/main/docs/api-doc-markdown.md",description:"This doc lists out the basic configurations for Windows in intune."},o=void 0,r={unversionedId:"Intune/Device-Configuration-&-Oboarding/Windows Device Config",id:"Intune/Device-Configuration-&-Oboarding/Windows Device Config",title:"Useful Windows Device Configuration",description:"This doc lists out the basic configurations for Windows in intune.",source:"@site/docs/Intune/Device-Configuration-&-Oboarding/Windows-Device-Config.md",sourceDirName:"Intune/Device-Configuration-&-Oboarding",slug:"/Intune/Device-Configuration-&-Oboarding/Windows Device Config",permalink:"/docs/Intune/Device-Configuration-&-Oboarding/Windows Device Config",draft:!1,editUrl:"https://github.com/facebook/docusaurus/edit/main/docs/api-doc-markdown.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{draft:!1,id:"Windows Device Config",title:"Useful Windows Device Configuration",hide_title:!1,hide_table_of_contents:!1,sidebar_label:"Windows Device Config",sidebar_position:1,toc_max_heading_level:4,pagination_label:"Windows Device Config",tags:[],custom_edit_url:"https://github.com/facebook/docusaurus/edit/main/docs/api-doc-markdown.md",description:"This doc lists out the basic configurations for Windows in intune."},sidebar:"tutorialSidebar",previous:{title:"Device Config/On-boarding",permalink:"/docs/category/device-configon-boarding"},next:{title:"Remediation Scripts",permalink:"/docs/category/remediation-scripts"}},s={},p=[{value:"Minimum Steps to build via Autopilot",id:"minimum-steps-to-build-via-autopilot",level:2},{value:"Deployment Methods",id:"deployment-methods",level:3},{value:"Deployment Steps",id:"deployment-steps",level:3},{value:"Device Configuration Profiles",id:"device-configuration-profiles",level:2},{value:"Compliance Policies",id:"compliance-policies",level:2},{value:"Update Rings",id:"update-rings",level:2},{value:"Pilot Policy",id:"pilot-policy",level:3},{value:"Production policy",id:"production-policy",level:3},{value:"Endpoint Security",id:"endpoint-security",level:2},{value:"Security Baselines",id:"security-baselines",level:3},{value:"Windows 10/11 baseline",id:"windows-1011-baseline",level:4},{value:"Disk Encryption (Bitlocker)",id:"disk-encryption-bitlocker",level:3},{value:"Antivirus",id:"antivirus",level:3},{value:"Scripts and Remediations",id:"scripts-and-remediations",level:2},{value:"Set the Default Windows Language (Script)",id:"set-the-default-windows-language-script",level:3},{value:"Disable access to FTP.exe (Remedition)",id:"disable-access-to-ftpexe-remedition",level:3},{value:"Detection Script",id:"detection-script",level:4},{value:"Remediation Script",id:"remediation-script",level:4},{value:"Disable Fast Startup",id:"disable-fast-startup",level:3},{value:"Detection Script",id:"detection-script-1",level:4},{value:"Remediation Script",id:"remediation-script-1",level:4},{value:"Uninstall Apps",id:"uninstall-apps",level:3},{value:"Lenovo AI Meeting App",id:"lenovo-ai-meeting-app",level:4},{value:"Applications",id:"applications",level:2},{value:"Removing Windows Bloatware",id:"removing-windows-bloatware",level:3}],u={toc:p},d="wrapper";function m(e){let{components:t,...n}=e;return(0,a.kt)(d,(0,i.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("hr",null),(0,a.kt)("p",null,"This doc lists out some useful Configuration Profiles for Windows devices. Specifically ones that I have come across and setup before as part of migrations."),(0,a.kt)("h2",{id:"minimum-steps-to-build-via-autopilot"},"Minimum Steps to build via Autopilot"),(0,a.kt)("hr",null),(0,a.kt)("p",null,"Autopilot settings to get a Windows build working in a basic sense."),(0,a.kt)("admonition",{title:"Autopilot Build Guidance",type:"info"},(0,a.kt)("p",{parentName:"admonition"},(0,a.kt)("a",{parentName:"p",href:"https://www.theitkb.co.uk/docs/Intune/Autopilot/Autopilot%20Setup%20Suggestions"},"Autopilot Setup Suggestions"))),(0,a.kt)("h3",{id:"deployment-methods"},"Deployment Methods"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Scenario"),(0,a.kt)("th",{parentName:"tr",align:"center"},"More Information"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Deploy and configure devices so that an end user can set it up for themselves"),(0,a.kt)("td",{parentName:"tr",align:"center"},(0,a.kt)("a",{parentName:"td",href:"https://learn.microsoft.com/en-us/autopilot/user-driven"},"Windows Autopilot user-driven mode"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Deploy devices to be automatically configured for shared use, as a kiosk, or as a digital signage device."),(0,a.kt)("td",{parentName:"tr",align:"center"},(0,a.kt)("a",{parentName:"td",href:"https://learn.microsoft.com/en-us/autopilot/self-deploying"},"Windows Autopilot self-deploying mode"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Pre-provision a device with up-to-date applications, policies, and settings."),(0,a.kt)("td",{parentName:"tr",align:"center"},(0,a.kt)("a",{parentName:"td",href:"https://learn.microsoft.com/en-us/autopilot/pre-provision"},"Pre-provisioning"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Deploy Windows 10/11 on an existing Windows device"),(0,a.kt)("td",{parentName:"tr",align:"center"},(0,a.kt)("a",{parentName:"td",href:"https://learn.microsoft.com/en-us/autopilot/existing-devices"},"Windows Autopilot for existing devices"))))),(0,a.kt)("h3",{id:"deployment-steps"},"Deployment Steps"),(0,a.kt)("p",null,"Step 1: Import Devices into Autopilot"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"The OEM can handle this upon purchase, just request it."),(0,a.kt)("li",{parentName:"ol"},"Alternatively, you can manually obtain the hash information and upload it to Autopilot using this Microsoft link.")),(0,a.kt)("p",null,"Step 2: Set Up Dynamic Groups in Azure AD"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("em",{parentName:"li"},"Intune - All Autopilot Devices")," - Use this query to target Autopilot profile."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("em",{parentName:"li"},"Intune - 3rd Party Patching")," - Use this query to target devices selected after Autopilot (to prevent app installations during Autopilot).")),(0,a.kt)("p",null,"Step 3: Create a Static Group for Users"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Name it ",(0,a.kt)("em",{parentName:"li"},"Intune - All Intune Users"),".")),(0,a.kt)("p",null,"Step 4: Configure Automatic Enrollment for Windows Devices"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Sign in to the Azure portal, then go to Azure Active Directory > Mobility (MDM and MAM) > Microsoft Intune."),(0,a.kt)("li",{parentName:"ol"},"Configure MDM User scope with ",(0,a.kt)("em",{parentName:"li"},"Intune - All Intune Users")," selected.")),(0,a.kt)("p",null,"Step 5: Set Up a Test Account (Intune.Tester@)"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Add this account to ",(0,a.kt)("em",{parentName:"li"},"Intune - All Intune Users")," group.")),(0,a.kt)("p",null,"Step 6: Configure Device Platform Restrictions"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Sign in to the Intune Admin Centre, then navigate to Devices > Enroll devices > Enrollment device platform restrictions."),(0,a.kt)("li",{parentName:"ol"},"Modify Windows Restrictions to allow Corporate Enrollment and block personal.")),(0,a.kt)("p",null,"Step 7: Configure Device Categories"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Sign in to the Intune Admin Centre, then go to Devices > Device categories."),(0,a.kt)("li",{parentName:"ol"},"Add at least one category.")),(0,a.kt)("p",null,"Step 8: Configure Autopilot Enrollment Profile"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Sign in to the Intune Admin Centre, then navigate to Devices > Enroll devices > Windows Enrollment > deployment profiles."),(0,a.kt)("li",{parentName:"ol"},"Create a profile and configure settings."),(0,a.kt)("li",{parentName:"ol"},"Assign it to the ",(0,a.kt)("em",{parentName:"li"},"Intune - All Autopilot Devices")," group.")),(0,a.kt)("p",null,"Step 9: Configure Enrollment Status Page"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Sign in to the Intune Admin Centre, then go to Devices > Enroll devices > Windows Enrollment > Enrollment Status Page."),(0,a.kt)("li",{parentName:"ol"},"Edit the Default option already set up."),(0,a.kt)("li",{parentName:"ol"},"Assign it to All Devices.")),(0,a.kt)("p",null,"Step 10: Additional Configuration"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Assign the Config profile & Compliance Profile to the All Autopilot Devices group."),(0,a.kt)("li",{parentName:"ol"},"Assign the Application deployment to your ",(0,a.kt)("em",{parentName:"li"},"Intune - 3rd Party Patching")," group."),(0,a.kt)("li",{parentName:"ol"},"Create a Device Encryption endpoint security policy."),(0,a.kt)("li",{parentName:"ol"},"Enable Defender for Endpoint Antimalware protection as needed.")),(0,a.kt)("h2",{id:"device-configuration-profiles"},"Device Configuration Profiles"),(0,a.kt)("hr",null),(0,a.kt)("p",null,"These are some standardised Config profiles that could be considered for deployment. Below is a quick look, select from the list to the right for the settings."),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"The format below is as follows:"),(0,a.kt)("ul",{parentName:"admonition"},(0,a.kt)("li",{parentName:"ul"},"Profile name (Type of Policy)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Policy Group\\Confgurable setting."))))),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("em",{parentName:"strong"},"Windows \u2013 Custom Branding")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"This one requires a Storage Account in Azure, google how to do this."))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("em",{parentName:"strong"},"Windows \u2013 Device Restrictions"))," (Device Restriction Policy)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"AppStore\\Use Private Store Only: Allow"),(0,a.kt)("li",{parentName:"ul"},"Cloud and Storage\\Microsoft Account: Block"),(0,a.kt)("li",{parentName:"ul"},"Cloud and Storage\\Non-Microsofft Account: Block"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("em",{parentName:"strong"},"Windows \u2013 Disable Microsoft Store"))," (Admin Template)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Windows Components\\Store\\Turn Off the offer to update to the latest version of Windows (User): Enabled"),(0,a.kt)("li",{parentName:"ul"},"Windows Components\\Store\\Turn off the store application (User): Enabled"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("em",{parentName:"strong"},"Windows \u2013 Enable Location Services"))," (Settings Catalog)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Privacy\\Let Apps Access Location: Force Allow."))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("em",{parentName:"strong"},"Windows \u2013 Enable Memory Integrity"))," (Settings Catalog)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Virtualization Based technology\\Hypervisor Enforced Code Integrity: (Enabeld with UEFI lock) Turns on Hypervisor-Protected Code Integrity with UEFI Lock."))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("em",{parentName:"strong"},"Windows \u2013 Hybrid Cloud Trust Configuration"))," (Necessary for a hybrid-on-prem WHfB solution.)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("em",{parentName:"strong"},"Windows \u2013 Lock Screen Password Reset"))," (Setting Catalgo)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Authentication\\Allow Aad password Reset: Allow"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("em",{parentName:"strong"},"Windows \u2013 Mapped Drives"))," (ADMX Import)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("em",{parentName:"strong"},"Windows \u2013 Microsoft Edge Settings"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("em",{parentName:"strong"},"Windows \u2013 OneDrive Configuration"))," (Admin Template)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Silently sign in users to the OneDrive sync app with their Windows credentials: Enabled"),(0,a.kt)("li",{parentName:"ul"},"Set the default location for the OneDrive folder: Enabled"),(0,a.kt)("li",{parentName:"ul"},"Prevent users from syncing personal OneDrive accounts: Enabled"),(0,a.kt)("li",{parentName:"ul"},"Allow syncing OneDrive accounts for only specific organizations: Enabled"),(0,a.kt)("li",{parentName:"ul"},"Prevent users from changing the location of their OneDrive folder: Enabled"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("em",{parentName:"strong"},"Wndows \u2013 Remove Teams Chat Icon")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Experience\\Configure chat icon: Disabled"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("em",{parentName:"strong"},"Windows \u2013 Trusted Locations")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Set office apps trusted locations."))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("em",{parentName:"strong"},"Windows \u2013 Offline Root CA Certificate"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("em",{parentName:"strong"},"Windows \u2013 Windows Update for Business Reporting"))," (Requires Azure resources.)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"System\\Allow commercial data pipeline: Enabled"),(0,a.kt)("li",{parentName:"ul"},"System\\Allow device name to be sent in Windows diagnostic data: Allowed."),(0,a.kt)("li",{parentName:"ul"},"System\\Allow Telemetry: Full"),(0,a.kt)("li",{parentName:"ul"},"System\\Allow update compliance Processing: Enabled"),(0,a.kt)("li",{parentName:"ul"},"System\\Configure Telemetry opt-in change notification: Disable telemetry change notifications"),(0,a.kt)("li",{parentName:"ul"},"System\\Configure telemetry opt-in settings UX"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Windows - Windows Hello for Business")," (This can be done from the enrolment area for all users)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Windows Hello for Business\\Configure Windows hello for business: Enable"),(0,a.kt)("li",{parentName:"ul"},"Windows Hello for Business\\Minimum PIN length: 6"),(0,a.kt)("li",{parentName:"ul"},"Windows Hello for Business\\Maximum PIN length: 127"),(0,a.kt)("li",{parentName:"ul"},"Windows Hello for Business\\Lowercase letters in PIN: Allowed"),(0,a.kt)("li",{parentName:"ul"},"Windows Hello for Business\\Uppdatecase letters in PIN: Allowed"),(0,a.kt)("li",{parentName:"ul"},"Windows Hello for Business\\Special Characters in PIN: Allowed"),(0,a.kt)("li",{parentName:"ul"},"Windows Hello for Business\\Pin Expiry: Never"),(0,a.kt)("li",{parentName:"ul"},"Windows Hello for Business\\Enable PIN recovery: Enable"),(0,a.kt)("li",{parentName:"ul"},"Windows Hello for Business\\Use TPM: Enable"),(0,a.kt)("li",{parentName:"ul"},"Windows Hello for Business\\Allow biometric Auth: Enable")))),(0,a.kt)("h2",{id:"compliance-policies"},"Compliance Policies"),(0,a.kt)("hr",null),(0,a.kt)("p",null,"Policy Name Suggestion: Windows - Default Compliance Policy"),(0,a.kt)("p",null,"Settings to Configure:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Device Health"),":",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Bitlocker: Required"),(0,a.kt)("li",{parentName:"ul"},"Secure Boot: Required"),(0,a.kt)("li",{parentName:"ul"},"Code Integrity: Required"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"System Security"),":",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Require Password type: Device Default"),(0,a.kt)("li",{parentName:"ul"},"Require Encryption of data storage on device: Required"),(0,a.kt)("li",{parentName:"ul"},"Firewall: Required"),(0,a.kt)("li",{parentName:"ul"},"Trusted Platform Moduel (TPM): Required"),(0,a.kt)("li",{parentName:"ul"},"Microsoft Defender AntiMalware: Required"),(0,a.kt)("li",{parentName:"ul"},"Real-Time protection: Enabled\n",(0,a.kt)("strong",{parentName:"li"},"- Microsoft Defender for Endpoint"),":\nRequire the device to be ad or under the machine risk score: Medium")))),(0,a.kt)("h2",{id:"update-rings"},"Update Rings"),(0,a.kt)("hr",null),(0,a.kt)("h3",{id:"pilot-policy"},"Pilot Policy"),(0,a.kt)("p",null,"Policy Name Suggestion: Windows - Pilot"),(0,a.kt)("p",null,"Settings to Configure:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Update Ring settings"),":"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Microsoft Product Updates: Allow"),(0,a.kt)("li",{parentName:"ul"},"Windows Drivers: Allow"),(0,a.kt)("li",{parentName:"ul"},"Quality update deferral period (days): 3"),(0,a.kt)("li",{parentName:"ul"},"Feature update deferral period (days): 60"),(0,a.kt)("li",{parentName:"ul"},"Update Windows 10 devices to the latest Win 11 release: No"),(0,a.kt)("li",{parentName:"ul"},"Set feature update uninstall period: 10"),(0,a.kt)("li",{parentName:"ul"},"Servicing Channel: General Availability"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"User Experience Settings")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Automatic Update behavior: Auto install at maintenance time"),(0,a.kt)("li",{parentName:"ul"},"Active hours start: 1 PM"),(0,a.kt)("li",{parentName:"ul"},"Active hours end: 4 PM"),(0,a.kt)("li",{parentName:"ul"},"Restart checks: Allowed"),(0,a.kt)("li",{parentName:"ul"},"Option to pause Windows updates: Disabled"),(0,a.kt)("li",{parentName:"ul"},"Option to check for Windows updates: Enabled"),(0,a.kt)("li",{parentName:"ul"},"Change notification update level: Use the default"),(0,a.kt)("li",{parentName:"ul"},"Use deadline settings: Allowed"),(0,a.kt)("li",{parentName:"ul"},"Deadline for feature updates: 1"),(0,a.kt)("li",{parentName:"ul"},"Deadline for quality updates: 2"),(0,a.kt)("li",{parentName:"ul"},"Grace period: 1"),(0,a.kt)("li",{parentName:"ul"},"Auto reboot before deadline: No")))),(0,a.kt)("h3",{id:"production-policy"},"Production policy"),(0,a.kt)("p",null,"Policy Name Suggestion: Windows - Production"),(0,a.kt)("p",null,"Settings to Configure:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Update Ring settings"),":"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Microsoft Product Updates: Allow"),(0,a.kt)("li",{parentName:"ul"},"Windows Drivers: Allow"),(0,a.kt)("li",{parentName:"ul"},"Quality update deferral period (days): 5"),(0,a.kt)("li",{parentName:"ul"},"Feature update deferral period (days): 90"),(0,a.kt)("li",{parentName:"ul"},"Update Windows 10 devices to the latest Win 11 release: No"),(0,a.kt)("li",{parentName:"ul"},"Set feature update uninstall period: 10"),(0,a.kt)("li",{parentName:"ul"},"Servicing Channel: General Availability"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"User Experience Settings")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Automatic Update behavior: Auto install at maintenance time"),(0,a.kt)("li",{parentName:"ul"},"Active hours start: 1 PM"),(0,a.kt)("li",{parentName:"ul"},"Active hours end: 4 PM"),(0,a.kt)("li",{parentName:"ul"},"Restart checks: Allowed"),(0,a.kt)("li",{parentName:"ul"},"Option to pause Windows updates: Disabled"),(0,a.kt)("li",{parentName:"ul"},"Option to check for Windows updates: Enabled"),(0,a.kt)("li",{parentName:"ul"},"Change notification update level: Use the default"),(0,a.kt)("li",{parentName:"ul"},"Use deadline settings: Allowed"),(0,a.kt)("li",{parentName:"ul"},"Deadline for feature updates: 1"),(0,a.kt)("li",{parentName:"ul"},"Deadline for quality updates: 2"),(0,a.kt)("li",{parentName:"ul"},"Grace period: 1"),(0,a.kt)("li",{parentName:"ul"},"Auto reboot before deadline: No")))),(0,a.kt)("h2",{id:"endpoint-security"},"Endpoint Security"),(0,a.kt)("hr",null),(0,a.kt)("p",null,"The settings below are some basics when setting up Endpoint Security, there are more to be considered."),(0,a.kt)("h3",{id:"security-baselines"},"Security Baselines"),(0,a.kt)("p",null,"Baselines are provided for and maintained by Microsoft to make deployment of remediations easier and standard. Updates to policies are provided through updated version of the policies."),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/windows/security/operating-system-security/device-management/windows-security-configuration-framework/windows-security-baselines"},"Microsoft document link explaining baselines.")),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"You must update the version of the baselines yourself, Microsoft will deploy new versions of the policy but, they will not update in your environment themselves."),(0,a.kt)("p",{parentName:"admonition"},(0,a.kt)("a",{parentName:"p",href:"https://techcommunity.microsoft.com/t5/intune-customer-success/new-microsoft-365-apps-security-baseline-profile-and-updates-to/ba-p/3830745"},"Example of changing baselines"))),(0,a.kt)("h4",{id:"windows-1011-baseline"},"Windows 10/11 baseline"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/mem/intune/protect/security-baseline-settings-mdm-all?pivots=mdm-november-2021"},"Microsoft doc link to the baseline")),(0,a.kt)("h3",{id:"disk-encryption-bitlocker"},"Disk Encryption (Bitlocker)"),(0,a.kt)("p",null,"Setting below are for silently encrypting device without user input or the user adding a Pin."),(0,a.kt)("admonition",{title:"Needs filling out!",type:"danger"},(0,a.kt)("p",{parentName:"admonition"},"Section needs some meat adding.")),(0,a.kt)("h3",{id:"antivirus"},"Antivirus"),(0,a.kt)("p",null,"Policy Name Suggestion: Windows - Default AV Policy"),(0,a.kt)("p",null,"Settings to Configure:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Defender"),":",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Allow Archive Scanning: Allowed."),(0,a.kt)("li",{parentName:"ul"},"Allow Behavior Monitoring: Allowed"),(0,a.kt)("li",{parentName:"ul"},"Allow Cloud Protection: Allowed"),(0,a.kt)("li",{parentName:"ul"},"Allow full scan on mapped network drives: Not allowed"),(0,a.kt)("li",{parentName:"ul"},"Allow Full scan removable disk scanning: Allowed"),(0,a.kt)("li",{parentName:"ul"},"[Deprecation]"," Allow Intrusion Prevention System: Allowed"),(0,a.kt)("li",{parentName:"ul"},"Allow scanning of all downloaded files and attachments: Allowed"),(0,a.kt)("li",{parentName:"ul"},"Allow real-time scanning: Allowed"),(0,a.kt)("li",{parentName:"ul"},"Allow scanning network files: Not allowed"),(0,a.kt)("li",{parentName:"ul"},"Allow user UI Access: Allowed"),(0,a.kt)("li",{parentName:"ul"},"Check for signatures before running scan: Enabled"),(0,a.kt)("li",{parentName:"ul"},"Days to retain clean malware: 3"),(0,a.kt)("li",{parentName:"ul"},"Disable catch-up full scan: Enabled"),(0,a.kt)("li",{parentName:"ul"},"Disable catch-up quick scan: Enabled"),(0,a.kt)("li",{parentName:"ul"},"Enable network protection: Enabled (Audit mode)"),(0,a.kt)("li",{parentName:"ul"},"Excluded Paths: Your discretion, include Intune management extension content folder."),(0,a.kt)("li",{parentName:"ul"},"PUA protection: Audit mode"),(0,a.kt)("li",{parentName:"ul"},"Signature update interval: 24"),(0,a.kt)("li",{parentName:"ul"},"Submit samples consent: Send safe samples automatically.")))),(0,a.kt)("h2",{id:"scripts-and-remediations"},"Scripts and Remediations"),(0,a.kt)("hr",null),(0,a.kt)("p",null,"Below are some examples of applying scripts and remediations to deploy from Intune."),(0,a.kt)("h3",{id:"set-the-default-windows-language-script"},"Set the Default Windows Language (Script)"),(0,a.kt)("p",null,"This can be done via policy now however, this is a tried & tested method for doing this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-powershell",metastring:"showLineNumbers",showLineNumbers:!0},"# sets system locale\nSet-WinSystemLocale en-GB\nSet-Culture en-GB\n\n# Sets GeoID to UK region\nSet-WinHomeLocation -GeoId 242\n\n# Sets current user language\nSet-WinUserLanguageList en-GB -Force\n")),(0,a.kt)("h3",{id:"disable-access-to-ftpexe-remedition"},"Disable access to FTP.exe (Remedition)"),(0,a.kt)("p",null,"This remediation script will detect if the ",(0,a.kt)("em",{parentName:"p"},"BUILTIN\\Users")," group has access to launch the ftp.exe application."),(0,a.kt)("h4",{id:"detection-script"},"Detection Script"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-powershell",metastring:"showLineNumbers",showLineNumbers:!0},'try {\n\n    $acl = Get-Acl C:\\Windows\\System32\\ftp.exe\n    if($acl.Access.identityReference.value -eq \'BUILTIN\\Users\') {\n        Write-Warning "Not Compliant"\n        Exit 1\n    } else {\n        Write-Output "Compliant"\n        Exit 0\n    }\n    \n}\ncatch {\n    Write-Warning "Not Compliant"\n    Exit 1\n}\n')),(0,a.kt)("h4",{id:"remediation-script"},"Remediation Script"),(0,a.kt)("p",null,"This will remove all of the permissions from the object & then set the permissions that are needed."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-powershell",metastring:"showLineNumbers",showLineNumbers:!0},'# The Script gathers the existing acl\'s on the .exe and then defines a new object matching the acl without touching inheritance\n$acl = Get-Acl C:\\Windows\\System32\\ftp.exe\n$inherit =[system.security.accesscontrol.InheritanceFlags]"ContainerInherit,ObjectInherit"\n$propagation =[system.security.accesscontrol.PropagationFlags]"None"\n$accessrule = New-Object System.Security.AccessControl.FileSystemAccessRule("BUILTIN\\Users","ReadAndExecute", $inherit, $Propagation ,,,"Allow")\n\n#The access rule is removed from the acl and the acl is then written to the .exe\n$acl.RemoveAccessRuleAll($accessrule)\nSet-Acl -AclObject $acl C:\\Windows\\System32\\ftp.exe\n')),(0,a.kt)("h3",{id:"disable-fast-startup"},"Disable Fast Startup"),(0,a.kt)("p",null,"This stops Windows loading apps into Storage when shutting down."),(0,a.kt)("h4",{id:"detection-script-1"},"Detection Script"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-powershell",metastring:"showLineNumbers",showLineNumbers:!0},'$Path = "HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Power"\n$Name = "HiberbootEnabled"\n$Type = "DWORD"\n$Value = 0\n \nTry {\n    $Registry = Get-ItemProperty -Path $Path -Name $Name -ErrorAction Stop | Select-Object -ExpandProperty $Name\n    If ($Registry -eq $Value){\n        Write-Output "Compliant"\n        Exit 0\n    } \n    Write-Warning "Not Compliant"\n    Exit 1\n} \nCatch {\n    Write-Warning "Not Compliant"\n    Exit 1\n}\n\n')),(0,a.kt)("h4",{id:"remediation-script-1"},"Remediation Script"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-powershell",metastring:"showLineNumbers",showLineNumbers:!0},"New-ItemProperty -LiteralPath 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Power' -Name 'HiberbootEnabled' -Value 0 -PropertyType DWord -Force -ea SilentlyContinue;\n")),(0,a.kt)("h3",{id:"uninstall-apps"},"Uninstall Apps"),(0,a.kt)("p",null,"Specifically a section on removing stubborn apps or bloatware."),(0,a.kt)("h4",{id:"lenovo-ai-meeting-app"},"Lenovo AI Meeting App"),(0,a.kt)("p",null,"Detection Script: "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-powershell",metastring:"showLineNumbers",showLineNumbers:!0},'Try {\n    \n    If (Test-path -Path "C:\\Program Files\\WindowsApps\\E046963F.AIMeetingManager_3.1.18.0_\xd764__k1h2ywk1493x8"){\n        Write-Output "Not Compliant"\n        Exit 1\n    } \n    Write-Warning "Compliant"\n    Exit 0\n} \nCatch {\n    Write-Warning "Not Compliant"\n    Exit 1\n}\n\n')),(0,a.kt)("p",null,"Remediation Script:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-powershell",metastring:"showLineNumbers",showLineNumbers:!0},"Remove-AppxPackage -AllUsers E046963F.AIMeetingManager_3.1.18.0_\xd764__k1h2ywk1493x8\n")),(0,a.kt)("h2",{id:"applications"},"Applications"),(0,a.kt)("hr",null),(0,a.kt)("p",null,"Section on adding\\removing applications from Windows build."),(0,a.kt)("h3",{id:"removing-windows-bloatware"},"Removing Windows Bloatware"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Create a new application for deployment."),(0,a.kt)("li",{parentName:"ol"},"Select Microsoft store (new)."),(0,a.kt)("li",{parentName:"ol"},"Search for the apps that need removing."),(0,a.kt)("li",{parentName:"ol"},"Set install behaviour to System."),(0,a.kt)("li",{parentName:"ol"},"Assignment group should be added to uninstall.")),(0,a.kt)("p",null,"If you cannot find the apps in the list, browser to the ",(0,a.kt)("a",{parentName:"p",href:"https://apps.microsoft.com/store/apps"},"microsoft store")," via browser."),(0,a.kt)("p",null,"Take the app ID from the url."),(0,a.kt)("hr",null),(0,a.kt)("p",null,"Created: 2023-09-23, Last Updated: 2023-10-01"))}m.isMDXComponent=!0}}]);